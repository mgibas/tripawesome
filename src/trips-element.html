<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/polymerfire/firebase-query.html">
<link rel="import" href="../bower_components/polymerfire/firebase-document.html">
<link rel="import" href="../bower_components/app-route/app-location.html">
<link rel="import" href="../bower_components/app-route/app-route.html">
<link rel="import" href="../bower_components/paper-fab/paper-fab.html">
<link rel="import" href="../bower_components/paper-input/paper-input.html">
<link rel="import" href="../bower_components/paper-dialog/paper-dialog.html">
<link rel="import" href="../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../bower_components/paper-listbox/paper-listbox.html">
<link rel="import" href="../bower_components/paper-fab-transitions/paper-fab-morph.html">
<link rel="import" href="../bower_components/iron-pages/iron-pages.html">
<link rel="import" href="../bower_components/neon-animation/neon-animated-pages.html">
<link rel="import" href="../bower_components/neon-animation/animations/slide-from-right-animation.html">
<link rel="import" href="../bower_components/neon-animation/animations/slide-from-left-animation.html">
<link rel="import" href="../bower_components/neon-animation/animations/slide-right-animation.html">
<link rel="import" href="../bower_components/neon-animation/animations/slide-left-animation.html">
<link rel="import" href="trip-card.html">
<link rel="import" href="trip-create.html">
<link rel="import" href="trip-element.html">
<dom-module id="trips-element">
    <template>
        <style include="shared-styles">
        :host {
            display: block;
        }
        
        #cards {
            padding-top: 1rem;
        }
        
        trip-card + trip-card {
            margin-top: 1rem;
        }
        
        trip-card {
            margin-left: 1rem;
            margin-right: 1rem;
        }
        
        trip-card[deleted] {
            margin-top: 0rem;
        }
        </style>
        <app-route route="{{route}}" pattern="/:key/:page" data="{{data}}" tail="{{tail}}"></app-route>
        <iron-pages class="flex" attr-for-selected="name" selected="[[data.page]]" entry-animation="slide-from-right-animation" exit-animation="slide-left-animation" fallback-selection="default">
            <div name="default">
                <firebase-query app-name="tripawesome" path="/trips" data="{{trips}}"></firebase-query>
                <firebase-document id="fbNewTrip" app-name="tripawesome" data="{{newTrip}}"></firebase-document>
                <div id="cards">
                    <template is="dom-repeat" items="{{trips}}" as="item">
                        <trip-card route="{{route}}" item="[[item]]" on-delete-trip="_deleteTrip" on-item-changed="itemChanged(item)"></trip-card>
                    </template>
                </div>
                <paper-fab icon="add" class="action-right" on-tap="_openCreatePage"></paper-fab>
            </div>
            <div name="details">
                <trip-element key="[[data.key]]" on-close="_closeTrip" route="{{tail}}"></trip-element>
            </div>
            <div name="create">
                <trip-create on-canceled="_closeCreatePage" on-created="_closeCreatePage"></trip-create>
            </div>
        </iron-pages>
    </template>
    <script>
    (() => {
        'use strict';

        class TripsElement {
            get is() {
                return 'trips-element';
            }
            get properties() {
                return {
                    trips: {
                        type: Array,
                        notify: true
                    }
                };
            }
            _openCreatePage() {
                this.set('data.page', 'create');
            }
            _closeCreatePage() {
                this.set('data.page', 'default');
            }
            _closeTrip() {
                this.set('route.path', '');
                this.set('data.page', 'default');
            }
        }
        Polymer(TripsElement);
    })();
    </script>
</dom-module>
