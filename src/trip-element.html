<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/iron-flex-layout/iron-flex-layout.html">
<link rel="import" href="../bower_components/iron-flex-layout/iron-flex-layout-classes.html">
<link rel="import" href="../bower_components/iron-icons/iron-icons.html">
<link rel="import" href="../bower_components/iron-pages/iron-pages.html">
<link rel="import" href="../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../bower_components/paper-fab/paper-fab.html">
<link rel="import" href="../bower_components/paper-material/paper-material.html">
<link rel="import" href="../bower_components/paper-material/paper-material-shared-styles.html">
<link rel="import" href="../bower_components/app-layout/app-toolbar/app-toolbar.html">
<link rel="import" href="../bower_components/app-layout/app-header/app-header.html">
<link rel="import" href="../bower_components/app-layout/app-scroll-effects/app-scroll-effects.html">
<link rel="import" href="places-search.html">

<dom-module id="trip-element">
    <template>
        <style include="iron-positioning paper-material-shared-styles">
            :host {
                display: block;
            }

            paper-material {
                background-color: #FFF;
                margin: 1rem 0rem;
                min-height: 400px;
            }

            paper-fab {
                position: fixed;
                right: 1rem;
                bottom: 1rem;
            }
        </style>
        <app-route route="{{route}}" pattern="/:key" data="{{routeData}}"></app-route>
        <firebase-document app-name="triptrip" path="/trips/[[routeData.key]]" data="{{trip}}"></firebase-document>

        <iron-pages selected="[[_currentPage]]">
            <div>
                <paper-material elevation="1">
                    <app-toolbar>
                        <paper-icon-button icon="arrow-back"></paper-icon-button>
                        <div title>[[trip.name]]</div>
                        <paper-icon-button icon="create"></paper-icon-button>
                        <paper-icon-button icon="more-vert"></paper-icon-button>
                    </app-toolbar>

                    <trips-goals-graph goals="[[trips.goals]]"></trips-goals-graph>
                </paper-material>
                <paper-fab icon="add" on-tap="_addGoal"></paper-fab>
            </div>
            <div>
                <places-search id="searchDialog" on-place-selected="_handlePlaceSelected"></places-search>
            </div>
        </iron-pages>
    </template>
    <script>
        (() => {
            'use strict';
            class TripElement {
                get is() {
                    return 'trip-element'
                }
                get properties() {
                    return {
                        _currentPage: {
                            type: Number,
                            value: 0
                        }
                    };
                }
                _addGoal() {
                    this._currentPage = 1;
                }
                _handlePlaceSelected(e, data) {
                    this._currentPage = 0;
                }
            }
            Polymer(TripElement);
        })();
    </script>
</dom-module>
